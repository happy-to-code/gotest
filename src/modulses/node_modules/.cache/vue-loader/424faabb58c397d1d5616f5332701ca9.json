{"remainingRequest":"E:\\python\\hz\\mq-admin\\node_modules\\_vue-loader@15.9.6@vue-loader\\lib\\index.js??vue-loader-options!E:\\python\\hz\\mq-admin\\src\\components\\Summernote\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\python\\hz\\mq-admin\\src\\components\\Summernote\\index.vue","mtime":1608694218757},{"path":"E:\\python\\hz\\mq-admin\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\python\\hz\\mq-admin\\node_modules\\_babel-loader@8.2.2@babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\python\\hz\\mq-admin\\node_modules\\_cache-loader@2.0.1@cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\python\\hz\\mq-admin\\node_modules\\_vue-loader@15.9.6@vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n\r\n/* eslint-disable */\r\nimport $ from 'jquery'\r\nimport 'bootstrap/dist/js/bootstrap.min'\r\nimport 'bootstrap/dist/css/bootstrap.css'\r\nimport 'summernote'\r\nimport 'summernote/dist/lang/summernote-zh-CN'\r\nimport 'summernote/dist/summernote.css'\r\nimport { getToken, uploadFile, deleteFile } from '@/api/qiniu'\r\nimport { qiniuHost, cdnHost } from '@/api/utils'\r\nimport lrz from 'lrz'\r\nimport moment from 'moment'\r\nexport default {\r\n  name: 'Summernote',\r\n  props: {\r\n    value: String\r\n  },\r\n  data() {\r\n    return {\r\n      // richContent: \"\"\r\n    }\r\n  },\r\n  methods: {\r\n    setContent(value){\r\n      $('#summernote').summernote('code',value)\r\n    }\r\n  },\r\n  mounted() {\r\n    const that = this\r\n    $('#summernote').summernote({\r\n      lang: 'zh-CN',\r\n      placeholder: '请输入内容',\r\n      height: 400,\r\n      width: '100%',\r\n      htmlMode: true,\r\n      toolbar: [\r\n        // ['style', ['bold', 'italic', 'underline', 'clear']],\r\n        // ['fontsize', ['fontsize']],\r\n        // ['fontname', ['fontname']],\r\n        // ['color', ['color']],\r\n        // ['para', ['ul', 'ol', 'paragraph']],\r\n        // ['insert', ['link', 'picture']],\r\n        // ['mybutton', ['myVideo']],\r\n        ['edit',['undo','redo']],//编辑\r\n        ['headline', ['style']],//大字标题\r\n        ['style', ['bold', 'italic', 'underline', 'superscript', 'subscript', 'strikethrough', 'clear']],//样式\r\n        ['fontface', ['fontname','color','fontsize']],//字体\r\n        ['para', ['ul', 'ol', 'paragraph', 'lineheight']],//对齐方式\r\n        ['height', ['height']],//行高(自定义行高时一定不要忘记写这个)\r\n        ['table', ['table']],//表单\r\n        ['insert', ['link','picture','hr']],//插入链接，图片，下划线\r\n        ['view', ['fullscreen', 'codeview']]//全屏，代码视图\r\n      ],\r\n      fontSizes: ['8', '9', '10', '11', '12', '14', '18', '24', '36'],\r\n      fontNames: [\r\n        'Arial', 'Arial Black', 'Comic Sans MS', 'Courier New',\r\n        'Helvetica Neue', 'Helvetica', 'Impact', 'Lucida Grande',\r\n        'Tahoma', 'Times New Roman', 'Verdana'\r\n      ],\r\n      buttons: {\r\n        myVideo: myVideoBtn\r\n      },\r\n      callbacks: {\r\n        onChange: function() {\r\n          that.$emit('input', $('#summernote').summernote('code'))\r\n        },\r\n        onImageUpload: function(files) {\r\n          getToken().then(data => {\r\n            for(var i = 0;i< files.length;i++){\r\n              var formData = new FormData()\r\n              formData.append('token', data.qiniu_token)\r\n              formData.append('key', 'Summernote/'+moment().format('x'))\r\n              formData.append('file', files.item(i))\r\n              uploadFile(formData).then(response => {\r\n                console.log(cdnHost + response.key)\r\n                $('#summernote').summernote('insertImage', cdnHost + response.key,response.key)\r\n              })\r\n            }\r\n          })\r\n\r\n          // for(var key in files){\r\n          //   lrz(files[key], { quality: 0.7 }).then((res) => {\r\n          //     getToken().then(data => {\r\n          //       uploadBase64(res.base64.replace('data:image/jpeg;base64,', ''), res.fileLen, data.qiniu_token).then(response => {\r\n          //         console.log('成功')\r\n          //         // var img=document.createElement('img');// @param {Node} node\r\n          //         // img.src=cdnHost + response.key\r\n          //         // $('#summernote').summernote('insertNode',img);\r\n          //         //$('#summernote').summernote('insertImage', cdnHost + response.key,response.key)\r\n          //       })\r\n          //     })\r\n          //   })\r\n          // }\r\n          // files.forEach(element => {\r\n          //   lrz(request.file, { quality: 0.7 }).then((res) => {\r\n          //     getToken().then(data => {\r\n          //       uploadBase64(res.base64.replace('data:image/jpeg;base64,', ''), res.fileLen, data.qiniu_token).then(response => {\r\n          //          $('#summernote').summernote('insertImage', cdnHost + response.key)\r\n          //       })\r\n          //     })\r\n          //   })\r\n          // })\r\n        }\r\n      }\r\n    })\r\n    $('#summernote').summernote('code',that.value);\r\n    // mounted中加入下面这段\r\n    window.uploadVideo = function() {\r\n      vm.showLoading = true // 因ship上传比较耗时，所以加了个loading提示\r\n      upload($('#video')[0].files[0]).then(url => {// upload是自定义的上传文件函数，这里是上传成功的回调，拿到视频的url\r\n        var node = document.createElement('div') // 创建节点，用于包裹视频，再加这一层是方便调视频样式\r\n        node.innerHTML = '<video controls=\"controls\" style=\"max-width:100%;\" src=\"' + url + '\" />'\r\n        node.cssText = 'width:100%;text-aligen:center;'\r\n        $('#summernote').summernote('insertNode', node)// 插入视频\r\n        vm.showLoading = false // 视频上传结束，去掉loading提示\r\n      })\r\n    }\r\n    var myVideoBtn = function(context) {\r\n      var ui = $.summernote.ui\r\n      // create button\r\n      var button = ui.button({\r\n        contents: '<i class=\"rich-video-icon\"/><input title=\"视频\" οnchange=\"uploadVideo()\" type=\"file\" id=\"videoInput\" accept=\"video/*\" style=\"opacity: 0; filter:Alpha(opacity=0);width:20px;height: 20px;margin-left: -20px;position:absolute;\">', // 这个是展示在富文本顶部的操作图标，这个rich-video-icon是自己写的\r\n        // tooltip: ''// todo 这个视频提示报错，未知原因\r\n        // click: function() {// 点击按钮触发事件，这边不需要用到\r\n          // context.invoke('editor.insertText', 'xxx')\r\n        // }\r\n      })\r\n      return button.render() // return button as jquery object\r\n    }\r\n  }\r\n}\r\n",null]}